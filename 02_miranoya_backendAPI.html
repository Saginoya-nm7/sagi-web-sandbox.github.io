<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/3.19.5/swagger-ui.css" >
    <style>
      .topbar {
        display: none;
      }
    </style>
  </head>

  <body>
    <div id="swagger-ui"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/3.19.5/swagger-ui-bundle.js"> </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/3.19.5/swagger-ui-standalone-preset.js"> </script>
    <script src="./openapi.js"> </script>
    <script>

        const spec = {
            "swagger": "2.0",
            "info": {
                "description": "",
                "version": "1.0.0",
                "title": "Miranoya Backend API"
            },
            "host": "localhost:8000",
            "tags": [
                {
                    "name": "Spot",
                    "description": "投稿データ(Spot)に関するあれこれ"
                },
                {
                    "name": "User",
                    "description": "Userに関するあれこれ"
                }
            ],
            "paths": {
                "/api/spot": {
                    "get": {
                        "tags": [
                            "Spot"
                        ],
                        "summary": "投稿データを一覧で取得",
                        "operationId": "getSpotList",
                        "consumes": [
                            "application/json"
                        ],
                        "produces": [
                            "application/json"
                        ],
                        "responses": {
                            "200": {
                                "description": "取得成功時",
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/definitions/Spot"
                                    }
                                }
                            }
                        }
                    },
                    "post": {
                        "tags": [
                            "Spot"
                        ],
                        "summary": "投稿データを投稿",
                        "operationId": "postSpot",
                        "consumes": [
                            "multipart/form-data"
                        ],
                        "produces": [
                            "application/json"
                        ],
                        "parameters": [
                            {
                                "name": "title",
                                "in": "formData",
                                "type": "string",
                                "description": "投稿タイトル",
                                "required": true
                            },
                            {
                                "name": "detail",
                                "in": "formData",
                                "type": "string",
                                "description": "投稿の詳細",
                                "required": false
                            },
                            {
                                "name": "lat",
                                "in": "formData",
                                "type": "number",
                                "format": "double",
                                "description": "緯度",
                                "required": true
                            },
                            {
                                "name": "lng",
                                "in": "formData",
                                "type": "number",
                                "format": "double",
                                "description": "経度",
                                "required": true
                            },
                            {
                                "name": "thumbnail",
                                "in": "formData",
                                "type": "file",
                                "description": "写真",
                                "required": true
                            },
                            {
                                "name": "sub_image_1",
                                "in": "formData",
                                "type": "file",
                                "description": "写真",
                                "required": false
                            },
                            {
                                "name": "sub_image_2",
                                "in": "formData",
                                "type": "file",
                                "description": "写真",
                                "required": false
                            },
                            {
                                "name": "sub_image_3",
                                "in": "formData",
                                "type": "file",
                                "description": "写真",
                                "required": false
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "投稿成功時",
                                "schema": {
                                    "$ref": "#/definitions/Spot"
                                }
                            },
                            "400": {
                                "description": "何らかの情報が足らなかった時",
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "title": {
                                                "type": "string",
                                                "example": "必須フィールドです"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "/api/spot/{id}": {
                    "get": {
                        "tags": [
                            "Spot"
                        ],
                        "summary": "投稿データを一覧で取得",
                        "operationId": "getSpotData",
                        "consumes": [
                            "application/json"
                        ],
                        "produces": [
                            "application/json"
                        ],
                        "parameters": [
                            {
                                "name": "id",
                                "in": "path",
                                "description": "投稿データのUUID",
                                "required": true,
                                "type": "string",
                                "format": "uuid"
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "取得成功時",
                                "schema": {
                                    "$ref": "#/definitions/Spot"
                                }
                            },
                            "404": {
                                "description": "存在しないUUIDを指定したとき",
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "detail": {
                                                "type": "string",
                                                "example": "該当のデータが見つかりません"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "patch": {
                        "tags": [
                            "Spot"
                        ],
                        "summary": "投稿データの更新",
                        "operationId": "patchSpotData",
                        "consumes": [
                            "application/json"
                        ],
                        "produces": [
                            "application/json"
                        ],
                        "parameters": [
                            {
                                "name": "id",
                                "in": "path",
                                "description": "投稿データのUUID",
                                "required": true,
                                "type": "string",
                                "format": "uuid"
                            },
                            {
                                "name": "body",
                                "in": "body",
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "agreed": {
                                            "type": "boolean",
                                            "example": true,
                                            "description": "「賛同」する場合はtrue, 取り消す場合はfalse\n(agreedかstatusどちらかを設定)"
                                        },
                                        "status": {
                                            "type": "string",
                                            "enum": [
                                                "保留中",
                                                "対処中",
                                                "対処済み"
                                            ],
                                            "default": "保留中",
                                            "description": "行政の対応状況を入力\n(agreedかstatusどちらかを設定)"
                                        }
                                    }
                                }
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "取得成功時",
                                "schema": {
                                    "$ref": "#/definitions/Spot"
                                }
                            }
                        }
                    }
                },
                "/login": {
                    "post": {
                        "tags": [
                            "User"
                        ],
                        "summary": "ログイン",
                        "operationId": "login",
                        "consumes": [
                            "application/json"
                        ],
                        "produces": [
                            "application/json"
                        ],
                        "parameters": [
                            {
                                "name": "body",
                                "in": "body",
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "email": {
                                            "type": "string",
                                            "format": "email",
                                            "description": "ログイン時に用いるEmailアドレス"
                                        },
                                        "password": {
                                            "type": "string",
                                            "format": "base64",
                                            "description": "パスワード"
                                        }
                                    }
                                }
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "取得成功時",
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "token": {
                                            "type": "string",
                                            "description": "JWTトークン"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "/registration": {
                    "post": {
                        "tags": [
                            "User"
                        ],
                        "summary": "ユーザー登録",
                        "operationId": "registration",
                        "consumes": [
                            "application/json"
                        ],
                        "produces": [
                            "application/json"
                        ],
                        "parameters": [
                            {
                                "name": "body",
                                "in": "body",
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "description": "ユーザー名"
                                        },
                                        "email": {
                                            "type": "string",
                                            "format": "email",
                                            "description": "Emailアドレス"
                                        },
                                        "password1": {
                                            "type": "string",
                                            "format": "password",
                                            "description": "パスワード"
                                        },
                                        "password2": {
                                            "type": "string",
                                            "format": "password",
                                            "description": "パスワード(確認用)"
                                        }
                                    }
                                }
                            }
                        ],
                        "responses": {
                            "200": {
                                "description": "登録成功時",
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "detail": {
                                            "type": "string",
                                            "example": "Verification Email Sent."
                                        }
                                    }
                                }
                            },
                            "400": {
                                "description": "内容に不備があるとき・Emailアドレスが登録済みのとき"
                            }
                        }
                    }
                }
            },
            "securityDefinitions": {
                "login": {
                    "type": "apiKey",
                    "name": "行政側ログイン(JWT)",
                    "in": "header"
                }
            },
            "definitions": {
                "Spot": {
                    "type": "object",
                    "required": [
                        "detail",
                        "lat",
                        "lng",
                        "thumbnail"
                    ],
                    "properties": {
                        "uuid": {
                            "type": "string",
                            "format": "uuid",
                            "description": "投稿データのuuid(サーバー側で自動付与)"
                        },
                        "detail": {
                            "type": "string",
                            "example": "崖崩れあり",
                            "description": "投稿データの概要"
                        },
                        "lat": {
                            "type": "number",
                            "format": "double",
                            "description": "緯度"
                        },
                        "lng": {
                            "type": "number",
                            "format": "double",
                            "description": "経度"
                        },
                        "place": {
                            "type": "string",
                            "example": "愛知県 豊橋市 天伯町",
                            "description": "緯度経度で表される地点の住所(サーバー側で自動付与)"
                        },
                        "thumbnail": {
                            "type": "string",
                            "format": "url",
                            "description": "画像へのURL"
                        },
                        "sub_image_1": {
                            "type": "string",
                            "format": "url",
                            "description": "画像へのURL"
                        },
                        "sub_image_2": {
                            "type": "string",
                            "format": "url",
                            "description": "画像へのURL"
                        },
                        "sub_image_3": {
                            "type": "string",
                            "format": "url",
                            "description": "画像へのURL"
                        },
                        "agreed": {
                            "type": "integer",
                            "format": "integer",
                            "default": 0,
                            "description": "投稿データに「賛同」した人の数"
                        },
                        "status": {
                            "type": "string",
                            "enum": [
                                "保留中",
                                "対処中",
                                "対処済み"
                            ],
                            "description": "行政の対応状況",
                            "default": "保留中"
                        }
                    }
                },
                "User": {
                    "type": "object",
                    "required": [
                        "name",
                        "email"
                    ],
                    "properties": {
                        "name": {
                            "type": "string",
                            "description": "ユーザー名"
                        },
                        "email": {
                            "type": "string",
                            "format": "email",
                            "description": "メールアドレス"
                        },
                        "is_staff": {
                            "type": "boolean",
                            "description": "スタッフアカウントフラグ"
                        },
                        "is_active": {
                            "type": "boolean",
                            "description": "アクティブアカウントフラグ"
                        }
                    }
                }
            }
        };

        window.onload = function() {
            window.ui = SwaggerUIBundle({
            spec: spec,
            dom_id: '#swagger-ui',
            deepLinking: true,
            presets: [
                SwaggerUIBundle.presets.apis,
                SwaggerUIStandalonePreset
            ],
            plugins: [
                SwaggerUIBundle.plugins.DownloadUrl
            ],
            layout: "StandaloneLayout"
        })
      }
  </script>
  </body>
</html>